<!DOCTYPE html>
<html lang="es">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Control Shaker</title>
        <script src="https://cdn.tailwindcss.com"></script>
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
        <script>
            tailwind.config = {
                theme: {
                    extend: {
                        colors: {
                            primary: '#3B82F6',
                            secondary: '#10B981',
                            dark: '#1F2937',
                            light: '#F9FAFB',
                        },
                        fontFamily: {
                            sans: ['Inter', 'sans-serif'],
                        },
                    }
                }
            }
        </script>
        <style>
            @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');

            body {
                font-family: 'Inter', sans-serif;
                background-color: #f3f4f6;
            }

            .gauge {
                position: relative;
                width: 200px;
                height: 100px;
                margin: 0 auto;
            }

            .gauge-body {
                width: 100%;
                height: 0;
                padding-bottom: 50%;
                background: #e0e0e0;
                border-top-left-radius: 100% 200%;
                border-top-right-radius: 100% 200%;
                overflow: hidden;
                position: relative;
            }

            .gauge-fill {
                position: absolute;
                top: 100%;
                left: 0;
                width: 100%;
                height: 100%;
                background: linear-gradient(90deg, #3B82F6, #10B981);
                transform-origin: center top;
                transform: rotate(0.5turn);
                transition: transform 0.5s ease-out;
            }

            .gauge-cover {
                width: 75%;
                height: 150%;
                background: white;
                border-radius: 50%;
                position: absolute;
                top: 25%;
                left: 50%;
                transform: translateX(-50%);
                display: flex;
                align-items: center;
                justify-content: center;
                font-size: 1.5rem;
                font-weight: bold;
            }

            .motor-step {
                transition: all 0.3s ease;
            }

            .motor-step.active {
                background-color: #3B82F6;
                color: white;
                transform: scale(1.1);
            }

            .chart-container {
                position: relative;
                height: 300px;
                width: 100%;
            }

            @keyframes pulse {
                0% {
                    opacity: 1;
                }

                50% {
                    opacity: 0.5;
                }

                100% {
                    opacity: 1;
                }
            }

            .pulse {
                animation: pulse 2s infinite;
            }
        </style>
    </head>
    <body class="bg-gray-100">
        <div class="min-h-screen">
            <!-- Header -->
            <header class="bg-white shadow-sm">
                <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4 flex justify-between items-center">
                    <div class="flex items-center space-x-4">
                        <div class="bg-blue-500 p-2 rounded-lg">
                            <i class="fas fa-microchip text-white text-2xl"></i>
                        </div>
                        <h1 class="text-2xl font-bold text-gray-800">Agitador Automatico (SHAKER)</h1>
                    </div>
                    <div class="flex items-center space-x-4">
                        <div class="relative">
                            <i class="fas fa-bell text-gray-500 text-xl cursor-pointer hover:text-blue-500"></i>
                            <span
                                class="absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full h-4 w-4 flex items-center justify-center">3</span>
                        </div>
                        <div
                            class="h-8 w-8 rounded-full bg-blue-500 flex items-center justify-center text-white font-bold">
                            JS</div>
                    </div>
                </div>
            </header>

            <!-- Main Content -->
            <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6">
                <!-- Status Cards -->
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                    <div class="bg-white rounded-lg shadow p-6">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-gray-500">Temperatura</p>
                                <h2 class="text-3xl font-bold text-gray-800 mt-2"><span
                                        id="temperature-value">24.5</span>°C</h2>
                            </div>
                            <div class="bg-blue-100 p-3 rounded-full">
                                <i class="fas fa-temperature-high text-blue-500 text-2xl"></i>
                            </div>
                        </div>
                        <div class="mt-4">
                            <div class="flex items-center justify-between text-sm text-gray-500">
                                <span>Min: 18°C</span>
                                <span>Max: 32°C</span>
                            </div>
                            <div class="w-full bg-gray-200 rounded-full h-2 mt-1">
                                <div id="temperature-bar" class="bg-blue-500 h-2 rounded-full" style="width: 60%"></div>
                            </div>
                        </div>
                    </div>

                    <div class="bg-white rounded-lg shadow p-6">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-gray-500">Humedad</p>
                                <h2 class="text-3xl font-bold text-gray-800 mt-2"><span id="humidity-value">65</span>%
                                </h2>
                            </div>
                            <div class="bg-green-100 p-3 rounded-full">
                                <i class="fas fa-tint text-green-500 text-2xl"></i>
                            </div>
                        </div>
                        <div class="mt-4">
                            <div class="flex items-center justify-between text-sm text-gray-500">
                                <span>Min: 30%</span>
                                <span>Max: 90%</span>
                            </div>
                            <div class="w-full bg-gray-200 rounded-full h-2 mt-1">
                                <div id="humidity-bar" class="bg-green-500 h-2 rounded-full" style="width: 65%"></div>
                            </div>
                        </div>
                    </div>

                    <div class="bg-white rounded-lg shadow p-6">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-gray-500">Estado del Motor</p>
                                <h2 class="text-3xl font-bold text-gray-800 mt-2"><span
                                        id="motor-status">Inactivo</span></h2>
                            </div>
                            <div class="bg-yellow-100 p-3 rounded-full">
                                <i class="fas fa-cog text-yellow-500 text-2xl"></i>
                            </div>
                        </div>
                        <div class="mt-4">
                            <div class="flex items-center justify-between text-sm text-gray-500">
                                <span>Pasos: <span id="step-count">0</span></span>
                                <span>Velocidad: <span id="motor-speed">0</span> rpm</span>
                            </div>
                            <div class="w-full bg-gray-200 rounded-full h-2 mt-1">
                                <div id="motor-bar" class="bg-yellow-500 h-2 rounded-full" style="width: 0%"></div>
                            </div>
                        </div>
                    </div>

                    <div class="bg-white rounded-lg shadow p-6">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-gray-500">Última Actualización</p>
                                <h2 class="text-3xl font-bold text-gray-800 mt-2"><span id="last-update">Hace 5s</span>
                                </h2>
                            </div>
                            <div class="bg-purple-100 p-3 rounded-full">
                                <i class="fas fa-clock text-purple-500 text-2xl"></i>
                            </div>
                        </div>
                        <div class="mt-4">
                            <div class="flex items-center justify-between text-sm text-gray-500">
                                <span>Estado:</span>
                                <span class="text-green-500 font-medium"><i class="fas fa-circle pulse"></i>
                                    Conectado</span>
                            </div>
                            <button id="refresh-btn"
                                class="w-full mt-2 bg-blue-500 hover:bg-blue-600 text-white py-1 px-4 rounded text-sm transition duration-300">
                                <i class="fas fa-sync-alt mr-2"></i> Actualizar Datos
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Charts and Controls -->
                <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 mb-8">
                    <!-- Temperature Gauge -->
                    <div class="bg-white rounded-lg shadow p-6 col-span-1">
                        <h3 class="text-lg font-semibold text-gray-800 mb-4">Temperatura Actual</h3>
                        <div class="gauge">
                            <div class="gauge-body">
                                <div class="gauge-fill" id="temperature-gauge"></div>
                                <div class="gauge-cover" id="temperature-gauge-value">24.5°C</div>
                            </div>
                        </div>
                        <div class="mt-6">
                            <div class="flex justify-between items-center mb-2">
                                <span class="text-sm text-gray-500">Histórico:</span>
                                <select class="text-sm border rounded px-2 py-1">
                                    <option>Última hora</option>
                                    <option>Últimas 24 horas</option>
                                    <option>Última semana</option>
                                </select>
                            </div>
                            <div class="chart-container">
                                <canvas id="temperature-chart"></canvas>
                            </div>
                        </div>
                    </div>

                    <!-- Humidity Gauge -->
                    <div class="bg-white rounded-lg shadow p-6 col-span-1">
                        <h3 class="text-lg font-semibold text-gray-800 mb-4">Humedad Actual</h3>
                        <div class="gauge">
                            <div class="gauge-body">
                                <div class="gauge-fill" id="humidity-gauge"></div>
                                <div class="gauge-cover" id="humidity-gauge-value">65%</div>
                            </div>
                        </div>
                        <div class="mt-6">
                            <div class="flex justify-between items-center mb-2">
                                <span class="text-sm text-gray-500">Histórico:</span>
                                <select class="text-sm border rounded px-2 py-1">
                                    <option>Última hora</option>
                                    <option>Últimas 24 horas</option>
                                    <option>Última semana</option>
                                </select>
                            </div>
                            <div class="chart-container">
                                <canvas id="humidity-chart"></canvas>
                            </div>
                        </div>
                    </div>

                    <!-- Motor Controls -->
                    <div class="bg-white rounded-lg shadow p-6 col-span-1">
                        <h3 class="text-lg font-semibold text-gray-800 mb-4">Control del Motor Paso a Paso</h3>
                        <div class="flex justify-center mb-6">
                            <div class="relative w-40 h-40">
                                <div class="absolute inset-0 rounded-full bg-gray-200 flex items-center justify-center">
                                    <div
                                        class="w-32 h-32 rounded-full bg-white shadow-inner flex items-center justify-center">
                                        <i class="fas fa-cog text-3xl text-gray-400" id="motor-icon"></i>
                                    </div>
                                </div>
                                <div class="motor-step absolute top-0 left-1/2 -ml-3 -mt-3 w-6 h-6 rounded-full bg-gray-300 flex items-center justify-center text-xs font-bold"
                                    data-step="1">1</div>
                                <div class="motor-step absolute top-1/2 right-0 -mr-3 -mt-3 w-6 h-6 rounded-full bg-gray-300 flex items-center justify-center text-xs font-bold"
                                    data-step="2">2</div>
                                <div class="motor-step absolute bottom-0 left-1/2 -ml-3 -mb-3 w-6 h-6 rounded-full bg-gray-300 flex items-center justify-center text-xs font-bold"
                                    data-step="3">3</div>
                                <div class="motor-step absolute top-1/2 left-0 -ml-3 -mt-3 w-6 h-6 rounded-full bg-gray-300 flex items-center justify-center text-xs font-bold"
                                    data-step="4">4</div>
                            </div>
                        </div>

                        <div class="mb-6">
                            <label class="block text-sm font-medium text-gray-700 mb-2">Velocidad (rpm)</label>
                            <input type="range" id="speed-control" min="0" max="100" value="0"
                                class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer">
                            <div class="flex justify-between text-xs text-gray-500 mt-1">
                                <span>0</span>
                                <span>25</span>
                                <span>50</span>
                                <span>75</span>
                                <span>100</span>
                            </div>
                        </div>

                        <div class="grid grid-cols-2 gap-4 mb-4">
                            <button id="move-cw"
                                class="bg-blue-500 hover:bg-blue-600 text-white py-2 px-4 rounded transition duration-300">
                                <i class="fas fa-rotate-right mr-2"></i> Sentido Horario
                            </button>
                            <button id="move-ccw"
                                class="bg-green-500 hover:bg-green-600 text-white py-2 px-4 rounded transition duration-300">
                                <i class="fas fa-rotate-left mr-2"></i> Antihorario
                            </button>
                        </div>

                        <div class="grid grid-cols-2 gap-4">
                            <button id="stop-motor"
                                class="bg-red-500 hover:bg-red-600 text-white py-2 px-4 rounded transition duration-300">
                                <i class="fas fa-stop mr-2"></i> Detener
                            </button>
                            <button id="reset-steps"
                                class="bg-gray-500 hover:bg-gray-600 text-white py-2 px-4 rounded transition duration-300">
                                <i class="fas fa-undo mr-2"></i> Reiniciar
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Data Table -->
                <div class="bg-white rounded-lg shadow overflow-hidden mb-8">
                    <div class="px-6 py-4 border-b border-gray-200 flex justify-between items-center">
                        <h3 class="text-lg font-semibold text-gray-800">Registro Histórico</h3>
                        <div class="flex space-x-2">
                            <button
                                class="text-sm bg-blue-500 hover:bg-blue-600 text-white py-1 px-3 rounded transition duration-300">
                                <i class="fas fa-download mr-1"></i> Exportar
                            </button>
                            <select class="text-sm border rounded px-2 py-1">
                                <option>Última hora</option>
                                <option>Últimas 24 horas</option>
                                <option>Última semana</option>
                            </select>
                        </div>
                    </div>
                    <div class="overflow-x-auto">
                        <table class="min-w-full divide-y divide-gray-200">
                            <thead class="bg-gray-50">
                                <tr>
                                    <th scope="col"
                                        class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                        Fecha/Hora</th>
                                    <th scope="col"
                                        class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                        Temperatura (°C)</th>
                                    <th scope="col"
                                        class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                        Humedad (%)</th>
                                    <th scope="col"
                                        class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                        Pasos del Motor</th>
                                    <th scope="col"
                                        class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                        Estado</th>
                                </tr>
                            </thead>
                            <tbody class="bg-white divide-y divide-gray-200" id="data-table-body">
                                <!-- Datos se llenarán dinámicamente -->
                            </tbody>
                        </table>
                    </div>
                    <div class="px-6 py-4 border-t border-gray-200 flex justify-between items-center">
                        <div class="text-sm text-gray-500">
                            Mostrando <span id="showing-from">1</span> a <span id="showing-to">5</span> de <span
                                id="total-items">24</span> registros
                        </div>
                        <div class="flex space-x-2">
                            <button class="px-3 py-1 border rounded text-sm disabled:opacity-50" id="prev-page"
                                disabled>
                                <i class="fas fa-chevron-left"></i>
                            </button>
                            <button class="px-3 py-1 border rounded text-sm bg-blue-500 text-white">1</button>
                            <button class="px-3 py-1 border rounded text-sm">2</button>
                            <button class="px-3 py-1 border rounded text-sm">3</button>
                            <button class="px-3 py-1 border rounded text-sm" id="next-page">
                                <i class="fas fa-chevron-right"></i>
                            </button>
                        </div>
                    </div>
                </div>
            </main>
        </div>

        <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
        <script>
            // Variables de estado
            let currentStep = 0;
            let motorDirection = 0; // 0: detenido, 1: horario, -1: antihorario
            let motorSpeed = 0;
            let stepCount = 0;
            let temperature = 24.5;
            let humidity = 65;
            let lastUpdate = new Date();
            let isMotorActive = false;

            // Elementos del DOM
            const temperatureValue = document.getElementById('temperature-value');
            const humidityValue = document.getElementById('humidity-value');
            const motorStatus = document.getElementById('motor-status');
            const stepCountElement = document.getElementById('step-count');
            const motorSpeedElement = document.getElementById('motor-speed');
            const lastUpdateElement = document.getElementById('last-update');
            const temperatureGauge = document.getElementById('temperature-gauge');
            const humidityGauge = document.getElementById('humidity-gauge');
            const temperatureGaugeValue = document.getElementById('temperature-gauge-value');
            const humidityGaugeValue = document.getElementById('humidity-gauge-value');
            const moveCwBtn = document.getElementById('move-cw');
            const moveCcwBtn = document.getElementById('move-ccw');
            const stopMotorBtn = document.getElementById('stop-motor');
            const resetStepsBtn = document.getElementById('reset-steps');
            const speedControl = document.getElementById('speed-control');
            const refreshBtn = document.getElementById('refresh-btn');
            const motorSteps = document.querySelectorAll('.motor-step');
            const motorIcon = document.getElementById('motor-icon');
            const temperatureBar = document.getElementById('temperature-bar');
            const humidityBar = document.getElementById('humidity-bar');
            const motorBar = document.getElementById('motor-bar');

            // Inicializar gráficos
            const temperatureCtx = document.getElementById('temperature-chart').getContext('2d');
            const humidityCtx = document.getElementById('humidity-chart').getContext('2d');

            const temperatureChart = new Chart(temperatureCtx, {
                type: 'line',
                data: {
                    labels: Array.from({ length: 12 }, (_, i) => `${i * 5} min`),
                    datasets: [{
                        label: 'Temperatura (°C)',
                        data: [22, 22.5, 23, 23.5, 24, 24.5, 24, 23.5, 23, 22.5, 22, 22.5],
                        borderColor: '#3B82F6',
                        backgroundColor: 'rgba(59, 130, 246, 0.1)',
                        borderWidth: 2,
                        fill: true,
                        tension: 0.4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: false,
                            min: 20,
                            max: 26
                        }
                    }
                }
            });

            const humidityChart = new Chart(humidityCtx, {
                type: 'line',
                data: {
                    labels: Array.from({ length: 12 }, (_, i) => `${i * 5} min`),
                    datasets: [{
                        label: 'Humedad (%)',
                        data: [60, 61, 62, 63, 64, 65, 64, 63, 62, 61, 60, 61],
                        borderColor: '#10B981',
                        backgroundColor: 'rgba(16, 185, 129, 0.1)',
                        borderWidth: 2,
                        fill: true,
                        tension: 0.4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: false,
                            min: 55,
                            max: 70
                        }
                    }
                }
            });

            // Llenar tabla con datos de ejemplo
            const tableBody = document.getElementById('data-table-body');
            const sampleData = [
                { date: '2023-06-01 10:00', temp: 22.5, hum: 60, steps: 0, status: 'Inactivo' },
                { date: '2023-06-01 10:05', temp: 23.0, hum: 61, steps: 120, status: 'Horario' },
                { date: '2023-06-01 10:10', temp: 23.5, hum: 62, steps: 240, status: 'Horario' },
                { date: '2023-06-01 10:15', temp: 24.0, hum: 63, steps: 0, status: 'Inactivo' },
                { date: '2023-06-01 10:20', temp: 24.5, hum: 65, steps: -80, status: 'Antihorario' }
            ];

            function populateTable() {
                tableBody.innerHTML = '';
                sampleData.forEach(data => {
                    const row = document.createElement('tr');
                    row.innerHTML = `
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">${data.date}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">${data.temp}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">${data.hum}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">${data.steps}</td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full 
                            ${data.status === 'Horario' ? 'bg-blue-100 text-blue-800' :
                            data.status === 'Antihorario' ? 'bg-green-100 text-green-800' :
                                'bg-gray-100 text-gray-800'}">
                            ${data.status}
                        </span>
                    </td>
                `;
                    tableBody.appendChild(row);
                });
            }

            // Funciones de control del motor
            function updateMotor() {
                // Actualizar pasos del motor
                if (motorDirection !== 0) {
                    currentStep = (currentStep + motorDirection + 4) % 4;
                    stepCount += motorDirection;

                    // Actualizar UI de pasos
                    motorSteps.forEach(step => {
                        step.classList.remove('active');
                        if (parseInt(step.dataset.step) === currentStep + 1) {
                            step.classList.add('active');
                        }
                    });

                    // Actualizar icono del motor
                    motorIcon.style.transform = `rotate(${stepCount * 9}deg)`;

                    // Actualizar contador de pasos
                    stepCountElement.textContent = Math.abs(stepCount);

                    // Actualizar barra de progreso del motor
                    const progress = Math.min(100, Math.abs(stepCount) / 10);
                    motorBar.style.width = `${progress}%`;
                }

                // Actualizar estado del motor
                if (motorDirection === 1) {
                    motorStatus.textContent = 'Horario';
                    motorStatus.className = 'text-blue-500';
                } else if (motorDirection === -1) {
                    motorStatus.textContent = 'Antihorario';
                    motorStatus.className = 'text-green-500';
                } else {
                    motorStatus.textContent = 'Inactivo';
                    motorStatus.className = 'text-gray-500';
                }

                // Actualizar velocidad del motor
                motorSpeedElement.textContent = motorSpeed;
            }

            // Event listeners
            moveCwBtn.addEventListener('click', () => {
                motorDirection = 1;
                isMotorActive = true;
                updateMotor();
            });

            moveCcwBtn.addEventListener('click', () => {
                motorDirection = -1;
                isMotorActive = true;
                updateMotor();
            });

            stopMotorBtn.addEventListener('click', () => {
                motorDirection = 0;
                isMotorActive = false;
                updateMotor();
            });

            resetStepsBtn.addEventListener('click', () => {
                stepCount = 0;
                updateMotor();
            });

            speedControl.addEventListener('input', () => {
                motorSpeed = speedControl.value;
                updateMotor();
            });

            refreshBtn.addEventListener('click', () => {
                // Simular nuevos datos
                temperature = (24 + Math.random() * 2).toFixed(1);
                humidity = Math.round(60 + Math.random() * 10);
                lastUpdate = new Date();

                // Actualizar UI
                temperatureValue.textContent = temperature;
                humidityValue.textContent = humidity;
                temperatureGaugeValue.textContent = `${temperature}°C`;
                humidityGaugeValue.textContent = `${humidity}%`;

                // Actualizar medidores
                const tempPercent = ((temperature - 18) / (32 - 18)) * 180;
                const humPercent = ((humidity - 30) / (90 - 30)) * 180;
                temperatureGauge.style.transform = `rotate(${tempPercent / 180}turn)`;
                humidityGauge.style.transform = `rotate(${humPercent / 180}turn)`;

                // Actualizar barras de progreso
                temperatureBar.style.width = `${(tempPercent / 180) * 100}%`;
                humidityBar.style.width = `${(humPercent / 180) * 100}%`;

                // Actualizar gráficos con datos aleatorios
                temperatureChart.data.datasets[0].data = temperatureChart.data.datasets[0].data.map(() =>
                    22 + Math.random() * 4
                );
                temperatureChart.update();

                humidityChart.data.datasets[0].data = humidityChart.data.datasets[0].data.map(() =>
                    60 + Math.random() * 10
                );
                humidityChart.update();

                // Actualizar última actualización
                lastUpdateElement.textContent = 'Ahora mismo';

                // Resetear después de 5 segundos
                setTimeout(() => {
                    lastUpdateElement.textContent = 'Hace unos segundos';
                }, 5000);
            });

            // Inicialización
            populateTable();
            updateMotor();

            // Simular datos en tiempo real
            setInterval(() => {
                if (isMotorActive) {
                    updateMotor();
                }
            }, 1000 / (motorSpeed || 1));
        </script>
    </body>
</html>